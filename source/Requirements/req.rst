Необходимая информация для установки кластера
==============================================

Для установки кластера **ADS** необходима следующая информация:

* IP-адреса всех серверов в кластере;

* Доступ к пользователю *root* / любому пользователю с правами *SUDO* на серверах кластера;

.. important:: В случае инсталляции без доступа в Интернет (offline) требуется доступ к развернутому на выделенном сервере `Arenadata Enterprise Tools <https://docs.arenadata.io/etools/ru/index.html>`_

.. important:: В случае инсталляции с доступом в Интернет требуется доступ к развернутому на выделенном сервере `Arenadata Cluster Manager <https://docs.arenadata.io/adcm/user/requisites.html>`_


Минимальные аппаратные требования
---------------------------------

Сеть
^^^^

Минимальные аппаратные требования к сети следующие:

* Наличие одной или нескольких выделенных и обособленных одноранговых Interconnect-сетей под цели внутренней коммуникации кластера;

* К Interconnect-сетям должны быть подключены все сервера кластера, серверам должны быть розданы адреса, и сервера должны "видеть" друг друга;

* Скорость Ethernet от *1 Гб/с* (стандартом является *10 Гб/с*);

* Отсутствие firewalls и другого ПО, блокирующего или замедляющего траффик;

* Внутри кластера должна быть открыта коммуникация по всем портам;

* Доступность Ping любого из серверов (ICMP);

* В кластерe должы быть открыты следующие порты:

.. csv-table:: Карта портов
   :header: "№ пп.", "Порт", "Описание"
   :widths: 10, 20, 70

   "1", "22", "ssh"
   "2", "81", "tcp-порт Arenadata Enterprise Tools (доступ к репозиториям в случае offline инсталляции)"
   "3", "2015", "tcp-порт для отправки метрик на сервер мониторинга"
   "4", "2016", "udp-порт для отправки метрик на сервер мониторинга"
   "5", "8000", "tcp-порт для отправки статусов компонентов кластера в ADCM"
   "6", "2181", "порт доступа к сервису *Zookeeper*"
   "7", "2888", "порт межсерверного взаимодествия для компонентов кворума *Zookeeper*"
   "8", "3888", "порт межсерверного взаимодествия для компонентов кворума *Zookeeper*"
   "9", "9092", "http-порт доступа к сервису *Kafka*"
   "10", "9093","https-порт доступа к сервису *Kafka*"
   "11", "8081", "порт доступа к сервису *Schema-Registry*"
   "12", "8082", "порт доступа к сервису *Kafka REST Proxy*"
   "13", "8088", "порт доступа к компоненту *KSQL Server*"
   "14", "9898", "порт доступа к сервису *Kafka-Manager*"
   "15", "9997", "JMX-порт для доступа к метрикам сервисa *Schema-Registry*"
   "16", "9998", "JMX-порт для доступа к метрикам сервисa *Kafka REST Proxy*"
   "17", "9999", "JMX-порт для доступа к метрикам сервиса *Kafka*"
   "18", "9090", "http-порт доступа к UI сервиса *Nifi*"
   "19", "9091", "https-порт доступа к UI сервиса *Nifi*"
   "20", "11443", "порт взаимодействия между серверами *Nifi*, объединенными в кластер"
   "21", "18080", "порт доступа к UI сервиса *Nifi-Registry*"


Zookeeper Server
^^^^^^^^^^^^^^^^^

Минимальные аппаратные требования к серверу *Zookeeper*:

* Физический сервер;

* RAM: от *8 Гб*;

* ROM: можно использовать как раздел мотированный под /, так и отдельный размером в *100 Гб*;

* CPU: от *4* ядер.

Kafka Broker
^^^^^^^^^^^^^

Минимальные аппаратные требования к отдельному брокеру *Kafka* для установки кластера ADS следующие:

* Физический сервер;

* RAM: от *16 Гб*;

* ROM: один или несколько физических RAID10-массив, форматированных в XFS;

* CPU: от *8* ядер.

Nifi Server
^^^^^^^^^^^^

Минимальные аппаратные требования к серверу *Nifi*:

* Физический сервер;

* RAM: от *16 Гб*;

* ROM: один или несколько физических RAID10-массивов, форматированных в XFS;

* CPU: от *8* ядер.


Программные требования
-----------------------

Минимальные программные требования для установки кластера ADS следующие:

* ОС – *RHEL/CentOS 7.6.1810*;

* Настроенный NTP на серверах;

* Процесс установки модифицирует следующие системные файлы:

    * */etc/hosts*

    * */etc/ssh/sshd_config*

    * */etc/selinux/config*

    * */etc/security/limits.conf*

    * */etc/sysctl.conf*

    * Создает новые файлы в */usr/lib/systemd/system/*

Перечисленные файлы не должны контролироваться системой управления конфигурации (при ее наличии);

* Процесс установки останавливает и выключает сервисы firewalld и SELinux, данные сервисы не должны контролироваться системой управления конфигурации (при ее наличии);

* Процесс установки создаёт новые сервисы, данные сервисы не должны контролироваться системой управления конфигурации (при ее наличии);

* Со всех машин в кластере должен быть доступ к официальному репозиторию CentOS Extras (например, РБК http://centos-mirror.rbc.ru/pub/centos/7/extras/x86_64/ или создано локальное зеркало);

* Со всех машин в кластере должен быть доступ к официальному репозиторию CentOS Updates (например, РБК http://centos-mirror.rbc.ru/pub/centos/7/updates/x86_64/ или создано локальное зеркало);

* Со всех машин в кластере должен быть доступ к официальному репозиторию CentOS Base (например, РБК http://centos-mirror.rbc.ru/pub/centos/7/os/x86_64/ или создано локальное зеркало).

.. important:: В случае инсталляции с доступом в Интернет также должны выполняться требования:
    
    * Со всех машин в кластере должен быть доступ к официальному репозиторию ADS: https://storage.googleapis.com/arenadata-repo/ADS/1.4.0/centos7/

    * Со всех машин в кластере должен быть доступ к официальному репозиторию Arenadata Monitoring: https://storage.googleapis.com/arenadata-repo/ADM/2.1/x64/
