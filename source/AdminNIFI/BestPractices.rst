Рекомендации по конфигурации
=============================

.. important:: При работе в Linux необходимо учесть последующие рекомендации и использовать их в качестве совета, так как типичные значения по умолчанию для Linux могут быть не настроены под нужды интенсивного приложения с высоким уровнем ввода-вывода, такого как NiFi


Максимальное число дескрипторов
--------------------------------

Серсис **NiFi** в любой момент может открыть очень большое количество файлов. Необходимо увеличить лимиты, отредактировав файл */etc/security/limits.conf*, например:

  ::
  
   *  hard  nofile  50000
   *  soft  nofile  50000


Maximum Forked Processes
------------------------

Серсис **NiFi** может быть настроен для генерации существенного количества потоков. Для увеличения их допустимого числа необходимо отредактировать файл */etc/security/limits.conf*, например:

  ::
  
   *  hard  nproc  10000
   *  soft  nproc  10000

При этом дистрибутив может потребовать так же изменить значение в */etc/security/limits.d/90-nproc.conf*, тогда следует добавить в него:

  ::
  
   *  soft  nproc  10000


Количество доступных портов TCP
---------------------------------

Увеличение количества доступных портов TCP особенно важно в случае, если поток устанавливает и срывает большое количество сокетов за короткий промежуток времени:

  ::
  
   sudo sysctl -w net.ipv4.ip_local_port_range="10000 65000"


Статус сокетов TIMED_WAIT 
--------------------------

С целью, чтобы сокеты долго не задерживались и при необходимости быстрой настройки и отключения новых сокетов, следует изменить время нахождения сокетов в статусе *TIMED_WAIT* при их закрытии, например:

  ::
  
   sudo sysctl -w net.ipv4.netfilter.ip_conntrack_tcp_timeout_time_wait="1"








